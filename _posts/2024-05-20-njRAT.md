---
title: njRAT Malware Analysis
date: 2024-05-20 12:00:00
categories: [Malware Analysis]
tags: [njrat,malware analysis]
comments: false
---

## Introduction

njRAT, also known as Bladabindi,[1] is a remote access tool (RAT) with user interface or trojan which allows the holder of the program to control the end-user's computer. It was first found in June 2013 with some variants traced to November 2012. It was made by a hacking organization from different countries called M38dHhM and was often used against targets in the Middle East. It can be spread through phishing and infected drives.

## njRAT Creator

The njRAT creator comes with quite a bit of files including a folder named "Plugin" which contains 6 dll files.

Upon executing the RAT creator it asks for a "Port" value which is the port the njRAT server should listen on.

At the bottom of the window we see an option called "Builder" which upon clicking opens a "Builder" window which is where we can select options and build our malware.

I build the malware with a few options selected as can be seen below

## Static Analysis

I started by taking a quick look at the created executable file properties but I did not find anything interesting.

Upon checking the PE file header I did not find anything unusual but I did find the presence of a .NET header indicating this is a .NET executable.

Checking the strings on file we get some interesting strings as listed below

### DnSpy

Since this is an .NET executable I decided to open the executable using DnSpy.

Starting with the main function. The main function calls another function "ko" in "OK"

In function "ko", it starts by checking if the malware was executed with any commandline arguments. If it was executed with commandline arguments then in registry under CurrentUser it sets the value of string “di” to “!” and then it puts the malware to sleep for 5000 seconds.

Then it creates a Mutex named "c4c160b1fc78444b2eebcebdee0dcb39". If the Mutex already exist then it terminates the executable.

Then we see a call to function “INS” in “OK”.
In the "INS" function, the initial action involves pausing the thread for 1000 seconds. Following this, while building the malware we had an option to "Copy" the malware if that option was selected then it checks if a file already exist at the choosen location with the choosen name if it does then it deletes that file and then copies the malware to the choosen location with the choosen name. After this it starts the malawre process from there and terminates the current process.

After this the malware adds itself itself to permitted programs in firewall settings and enables it using the command "netsh firewall add allowedprogram \”*executable path*\*executable name*\ ENABLE"

Following this if we had selected "Registry StarUP" option when building the malware then in registry under CurrentUser it creates an entry at location "Software\Microsoft\Windows\CurrentVersion\Run" with value “*/path/and/name/of/executable*”.

If we had selected “copy to StartUP” option when building the malware it sets the malware file attribute to hidden and copies it to windows startup folder.



